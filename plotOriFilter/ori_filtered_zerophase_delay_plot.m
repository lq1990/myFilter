ori = [7.0, 4.6273073829405185, 3.042013467133261, 7.542859672001882, 9.749923490411728, 13.090169943749475, 7.980655701641791, -5.319292809171913, -7.108296509971623, -4.5690307977544276, -6.510565162951535, -7.200491536685098, -11.870330238144987, -11.305465954255009, 1.9097866249815936, 8.090169943749485, 6.77252204241173, 7.154792919598085, 5.317148323658091, 9.132581267728419, 12.877852522924734, 2.2433276131470583, -7.150017832273187, -8.517211836771324, -9.121219541535343, -5.000000000000008, -5.8851515640355565, -12.321437901951938, -5.913949854773376, 4.594468622316926, 8.877852522924726, 11.483722276898318, 6.5532163011578834, 3.350566854417459, 10.008590019911503, 8.090169943749514, -1.3262813525181905, -7.5012398890743945, -13.106398215644793, -9.551632545854998, -2.510565162951538, -6.920171806924328, -8.34436448747144, -1.5150667439913077, 4.744587724141997, 13.090169943749483, 12.985991467911527, 3.7386336068212844, 4.278081444633028, 6.978448392110426, 3.000000000000009, -1.5371374391910824, -11.132183410882739, -15.63302961575134, -6.6597535466622695, -3.0901699437494634, -4.89048575789227, -2.7708771345775896, -0.9818734337778465, 7.659200741503804, 16.510565162951533, 10.290661480434617, 3.780160294395537, 3.215296010505563, 1.1803833187678798, 1.9098300562505046, -3.682352098662242, -15.24496286334756, -13.407318267407593, -6.042411323978989, -2.87785252292477, 0.8468423306024211, -0.9401521114762706, 0.42704189302179585, 12.21138948528478, 14.999999999999995, 8.975321507785049, 4.231267958202436, -2.1762200889760566, -1.5042986785674242, 1.1221474770752797, -8.393552333148845, -14.64338624490735, -11.44073679816699, -6.918420076162079, 1.9098300562504624, 4.416451296267694, -0.5889300546750427, 5.016228271895255, 12.641802489604514, 12.51056516295153, 10.010341750673767, 0.25419454372198, -6.575103199758153, -1.654417780392574, -3.090169943749364, -9.895821524162054, -11.828803550570726, -12.36825138838254, -3.8882784483610404, 6.999999999999983, 4.627307382940529, 3.042013467133199, 7.542859672001862, 9.749923490411692, 13.09016994374946, 7.980655701641762, -5.319292809171943, -7.1082965099716375, -4.569030797754421, -6.51056516295154, -7.200491536685179, -11.870330238144993, -11.305465954255194, 1.9097866249813635, 8.090169943749492, 6.772522042411657, 7.154792919598133, 5.31714832365812, 9.132581267728344, 12.877852522924748, 2.243327613147084, -7.15001783227312, -8.5172118367713, -9.121219541535359, -5.0000000000000675, -5.8851515640356045, -12.321437901951894, -5.913949854773438, 4.594468622316911, 8.877852522924742, 11.483722276898416, 6.553216301157929, 3.350566854417486, 10.00859001991154, 8.090169943749471, -1.326281352518204, -7.5012398890744105, -13.106398215644763, -9.551632545855146, -2.510565162951565, -6.920171806924145, -8.34436448747149, -1.515066743991394, 4.7445877241419625, 13.090169943749421, 12.985991467911667, 3.7386336068213426, 4.278081444632944, 6.97844839211051, 2.9999999999999902, -1.5371374391909696, -11.132183410882735, -15.633029615751367, -6.659753546662218, -3.090169943749414, -4.890485757892343, -2.7708771345775722, -0.9818734337778587, 7.65920074150402, 16.51056516295153, 10.290661480434544, 3.780160294395471, 3.215296010505578, 1.1803833187679982, 1.9098300562504666, -3.682352098662041, -15.244962863347471, -13.407318267407643, -6.0424113239788655, -2.8778525229247833, 0.8468423306024262, -0.9401521114762436, 0.42704189302176276, 12.211389485284665, 15.000000000000027, 8.97532150778503, 4.231267958202509, -2.176220088975997, -1.5042986785675239, 1.1221474770752362, -8.393552333148786, -14.643386244907363, -11.440736798166888, -6.91842007616213, 1.9098300562504822, 4.416451296267618, -0.5889300546750913, 5.016228271895146, 12.64180248960437, 12.510565162951579, 10.010341750673845, 0.2541945437222143, -6.575103199758261, -1.6544177803925721, -3.090169943749365, -9.895821524162013, -11.828803550570765, -12.368251388382577, -3.8882784483610857, 6.999999999999965, 4.627307382940679, 3.042013467133172, 7.542859672001769, 9.749923490411861, 13.090169943749366, 7.980655701641925, -5.319292809171642, -7.1082965099716775, -4.569030797754218, -6.510565162951558, -7.200491536685024, -11.870330238145078, -11.305465954255249, 1.9097866249817126, 8.09016994374945, 6.772522042411769, 7.154792919598049, 5.317148323658108, 9.132581267728439, 12.877852522924705, 2.243327613147285, -7.150017832273355, -8.517211836771345, -9.121219541535481, -5.000000000000099, -5.885151564035294, -12.321437901951912, -5.913949854773827, 4.5944686223166915, 8.877852522924613, 11.48372227689837, 6.553216301158071, 3.3505668544174334, 10.008590019911294, 8.090169943749519, -1.3262813525180437, -7.50123988907444, -13.106398215644738, -9.55163254585511, -2.510565162951549, -6.92017180692433, -8.344364487471536, -1.5150667439911913, 4.7445877241418035, 13.090169943749576, 12.985991467911692, 3.738633606821152, 4.278081444633065, 6.978448392110371, 3.000000000000078, -1.5371374391907564, -11.132183410882718, -15.633029615751488, -6.659753546662477, -3.0901699437494345];
 
filteredZeroPhase = [2.9915035230513514, 5.414352879403726, 7.5504038429632745, 8.900717600102059, 9.336562044454935, 8.26217629998696, 5.366788213258446, 1.1280333860985559, -3.6405750328165474, -7.642191503846299, -9.90701568407799, -10.56662713816538, -9.161386635615903, -5.788273935126535, -1.3377014243696068, 3.4646385952619987, 7.405853989350058, 9.715630546851934, 10.526659371939065, 9.436210225441748, 6.371455945038541, 2.0893713229324655, -2.7685778062612467, -6.997311086214043, -9.543552264217062, -10.494982374600523, -9.650380562209572, -6.8717268900390325, -2.809382585134089, 2.01175602124647, 6.5035029832778894, 9.358594923755751, 10.485854593066227, 9.84121474302695, 7.299025691357546, 3.4646385952620022, -1.2308731263770871, -5.913858131301545, -9.12058185674307, -10.489011836479397, -10.039062722317352, -7.68276908559084, -4.042253143161801, 0.4699175205364752, 5.243223973355525, 8.796739335683709, 10.474186584440238, 10.25505694659202, 8.059604942459181, 4.554080080379706, 0.23524262536256546, -4.527112222861717, -8.374211986778903, -10.403275015863889, -10.476431723228755, -8.458301123197911, -5.031812516159025, -0.8693039821583914, 3.8092556565877254, 7.8649675464807896, 10.245453896563774, 10.671210297369374, 8.887584370169034, 5.514471669679669, 1.4422845835736138, -3.126200382776193, -7.301270830146068, -9.989432812298837, -10.800461637385977, -9.33162706623778, -6.0330177325527705, -1.9847881637285, 2.494775540814338, 6.723508820767136, 9.648135423421023, 10.833420587086303, 9.754963721413564, 6.5979246245921574, 2.535580319687219, -1.9071728620424637, -6.165064770792085, -9.25401176455176, -10.759656858513129, -10.115017008473856, -7.194442532153581, -3.126200382776225, 1.3354562855810679, 5.640055865854657, 8.846779591296178, 10.593594995683384, 10.377500934803141, 7.787352244794824, 3.7684508777149164, -0.74371978598335, -5.138640814151512, -8.458301123197892, -10.369603425236228, -10.528859212038906, -8.333407207906081, -4.449496921175748, 0.10319558712318233, 4.631695382065661, 8.10040972133198, 10.129472750416966, 10.581014882432711, 8.796739335683686, 5.136395675362997, 0.595501716711495, -4.083057922034627, -7.76038438727683, -9.907015684078026, -10.56662713816545, -9.161386635616, -5.788273935126641, -1.3377014243697143, 3.4646385952619045, 7.405853989349992, 9.715630546851912, 10.526659371939074, 9.436210225441771, 6.371455945038574, 2.089371322932498, -2.7685778062612263, -6.99731108621404, -9.54355226421707, -10.49498237460055, -9.650380562209607, -6.871726890039063, -2.8093825851341054, 2.0117560212464705, 6.503502983277913, 9.3585949237558, 10.485854593066282, 9.841214743026988, 7.29902569135756, 3.4646385952619956, -1.2308731263771036, -5.913858131301566, -9.120581856743097, -10.489011836479424, -10.03906272231737, -7.682769085590848, -4.042253143161814, 0.4699175205364625, 5.243223973355517, 8.79673933568371, 10.474186584440245, 10.25505694659204, 8.05960494245921, 4.5540800803797445, 0.23524262536261076, -4.527112222861683, -8.374211986778887, -10.40327501586388, -10.476431723228744, -8.458301123197897, -5.031812516158995, -0.869303982158363, 3.8092556565877467, 7.86496754648081, 10.245453896563784, 10.671210297369376, 8.887584370169039, 5.514471669679682, 1.4422845835736466, -3.1262003827761378, -7.301270830145993, -9.989432812298753, -10.800461637385894, -9.331627066237724, -6.033017732552756, -1.9847881637285103, 2.494775540814313, 6.723508820767113, 9.648135423421005, 10.83342058708629, 9.754963721413558, 6.597924624592157, 2.535580319687219, -1.9071728620424573, -6.165064770792073, -9.254011764551745, -10.759656858513097, -10.115017008473847, -7.194442532153591, -3.126200382776261, 1.335456285581009, 5.640055865854586, 8.84677959129612, 10.593594995683343, 10.377500934803145, 7.787352244794866, 3.7684508777149754, -0.7437197859832947, -5.1386408141514766, -8.458301123197888, -10.369603425236248, -10.528859212038922, -8.333407207906111, -4.449496921175765, 0.10319558712317328, 4.63169538206566, 8.100409721331989, 10.129472750416983, 10.581014882432774, 8.796739335683775, 5.136395675363109, 0.59550171671161, -4.0830579220345165, -7.760384387276732, -9.907015684077942, -10.56662713816538, -9.161386635615955, -5.7882739351266, -1.3377014243696688, 3.4646385952619543, 7.405853989350061, 9.715630546851973, 10.526659371939097, 9.43621022544177, 6.37145594503855, 2.089371322932473, -2.7685778062612414, -6.997311086214045, -9.543552264217082, -10.494982374600573, -9.650380562209651, -6.871726890039142, -2.809382585134209, 2.011756021246349, 6.503502983277786, 9.358594923755685, 10.485854593066191, 9.841214743026956, 7.299025691357569, 3.464638595262036, -1.2308731263770596, -5.913858131301554, -9.1205818567431, -10.489011836479431, -10.039062722317382, -7.682769085590851, -4.04225314316182, 0.4699175205364458, 5.243223973355493, 8.796739335683704, 10.622843791164954, 10.422952464159442, 8.08826643256166, 4.121994160464116, -0.7701445641622935, -5.412881702767487, -8.31237029727298, -9.03384644780419, -7.964049055955948, -5.684225362172753];

delayF = [0.2127805904338927, 0.26041632743858906, 0.10208527171673955, -0.0345093331669184, -0.1494764186894637, -0.13264470019745037, -0.18405303758439695, -0.41910545896072615, -0.15783150581619543, 1.0282186543878382, 2.9915035230513514, 5.414352879403726, 7.550403842963273, 8.90071760010206, 9.336562044454935, 8.262176299986958, 5.366788213258445, 1.1280333860985563, -3.640575032816547, -7.642191503846297, -9.90701568407799, -10.566627138165382, -9.161386635615905, -5.788273935126535, -1.3377014243696064, 3.464638595261998, 7.4058539893500575, 9.715630546851937, 10.526659371939067, 9.436210225441748, 6.371455945038541, 2.0893713229324655, -2.768577806261247, -6.997311086214044, -9.54355226421706, -10.494982374600522, -9.650380562209572, -6.8717268900390325, -2.8093825851340886, 2.01175602124647, 6.503502983277889, 9.358594923755751, 10.485854593066227, 9.84121474302695, 7.299025691357544, 3.464638595262002, -1.2308731263770873, -5.913858131301543, -9.12058185674307, -10.4890118364794, -10.039062722317356, -7.682769085590838, -4.042253143161802, 0.4699175205364751, 5.243223973355525, 8.796739335683709, 10.47418658444024, 10.25505694659202, 8.05960494245918, 4.554080080379705, 0.23524262536256518, -4.527112222861719, -8.374211986778903, -10.403275015863887, -10.476431723228753, -8.458301123197911, -5.031812516159024, -0.8693039821583916, 3.809255656587726, 7.864967546480791, 10.245453896563772, 10.671210297369374, 8.887584370169034, 5.514471669679669, 1.4422845835736138, -3.126200382776194, -7.301270830146067, -9.989432812298837, -10.800461637385975, -9.33162706623778, -6.033017732552771, -1.9847881637284996, 2.494775540814338, 6.723508820767135, 9.648135423421024, 10.833420587086302, 9.754963721413564, 6.597924624592158, 2.5355803196872184, -1.907172862042463, -6.165064770792085, -9.254011764551763, -10.75965685851313, -10.115017008473858, -7.194442532153581, -3.1262003827762257, 1.3354562855810679, 5.640055865854658, 8.84677959129618, 10.593594995683386, 10.377500934803143, 7.787352244794824, 3.7684508777149164, -0.74371978598335, -5.138640814151513, -8.458301123197892, -10.369603425236228, -10.528859212038903, -8.33340720790608, -4.449496921175749, 0.10319558712318266, 4.6316953820656614, 8.10040972133198, 10.129472750416967, 10.581014882432713, 8.796739335683688, 5.136395675362999, 0.5955017167114952, -4.083057922034627, -7.76038438727683, -9.907015684078026, -10.56662713816545, -9.161386635616, -5.788273935126641, -1.337701424369715, 3.4646385952619054, 7.4058539893499935, 9.715630546851909, 10.526659371939076, 9.436210225441771, 6.371455945038574, 2.089371322932498, -2.768577806261227, -6.997311086214044, -9.543552264217068, -10.494982374600546, -9.650380562209607, -6.871726890039063, -2.8093825851341054, 2.01175602124647, 6.503502983277915, 9.358594923755799, 10.485854593066282, 9.84121474302699, 7.29902569135756, 3.4646385952619956, -1.2308731263771036, -5.913858131301567, -9.120581856743097, -10.48901183647942, -10.03906272231737, -7.682769085590848, -4.042253143161814, 0.4699175205364624, 5.243223973355516, 8.79673933568371, 10.474186584440245, 10.25505694659204, 8.059604942459208, 4.554080080379745, 0.2352426253626113, -4.527112222861683, -8.374211986778889, -10.40327501586388, -10.476431723228742, -8.458301123197895, -5.031812516158996, -0.869303982158363, 3.8092556565877467, 7.864967546480811, 10.245453896563783, 10.671210297369377, 8.887584370169037, 5.514471669679683, 1.4422845835736464, -3.126200382776138, -7.3012708301459925, -9.989432812298753, -10.800461637385894, -9.331627066237726, -6.033017732552756, -1.9847881637285099, 2.494775540814313, 6.723508820767114, 9.648135423421001, 10.833420587086287, 9.75496372141356, 6.597924624592157, 2.535580319687218, -1.9071728620424575, -6.165064770792073, -9.254011764551743, -10.759656858513098, -10.115017008473847, -7.19444253215359, -3.126200382776261, 1.335456285581009, 5.640055865854585, 8.846779591296118, 10.593594995683343, 10.377500934803141, 7.787352244794866, 3.7684508777149763, -0.7437197859832949, -5.1386408141514766, -8.458301123197886, -10.369603425236248, -10.528859212038922, -8.333407207906108, -4.449496921175767, 0.10319558712317317, 4.631695382065661, 8.100409721331987, 10.129472750416983, 10.581014882432774, 8.796739335683773, 5.13639567536311, 0.59550171671161, -4.083057922034517, -7.7603843872767335, -9.907015684077944, -10.56662713816538, -9.161386635615951, -5.7882739351266, -1.3377014243696692, 3.4646385952619543, 7.405853989350061, 9.715630546851973, 10.526659371939095, 9.43621022544177, 6.371455945038549, 2.089371322932473, -2.7685778062612414, -6.9973110862140455, -9.54355226421708, -10.494982374600575, -9.650380562209651, -6.871726890039143, -2.8093825851342094, 2.011756021246349, 6.503502983277788, 9.358594923755684, 10.48585459306619, 9.841214743026956, 7.299025691357567, 3.464638595262037, -1.2308731263770596, -5.913858131301553, -9.120581856743101, -10.489011836479431, -10.039062722317382, -7.682769085590851, -4.042253143161821, 0.4699175205364459, 5.2432239733554935, 8.796739335683705];


figure;
subplot(311)
plot(ori); grid on; title('original data in time domain')
subplot(312)
plot(filteredZeroPhase); grid on; title('filtered, zero phase')
subplot(313)
plot(delayF); grid on; title('filtered, delay')


